{% extends 'finance/base.html' %}
{% block title %}Операция {{ entry.pk|slice:":8" }}{% endblock %}
{% block content %}
<div class="container mx-auto px-4 py-6">
	<h1 class="text-2xl font-bold text-gray-900 mb-4">Операция {{ entry.date }} — {{ entry.memo }}</h1>
	<div class="bg-white border border-gray-200 rounded-lg overflow-hidden mb-6">
		<div class="overflow-x-auto">
			<table class="min-w-full divide-y divide-gray-200">
				<thead class="bg-gray-50">
					<tr>
						<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Счет</th>
						<th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Описание</th>
						<th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase">Дебет</th>
						<th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase">Кредит</th>
					</tr>
				</thead>
				<tbody class="bg-white divide-y divide-gray-100">
					{% for line in entry.lines.all %}
					<tr>
						<td class="px-6 py-3 text-sm text-gray-900">{{ line.account.code }} {{ line.account.name }}</td>
						<td class="px-6 py-3 text-sm text-gray-900">{{ line.description|default:'-' }}</td>
						<td class="px-6 py-3 text-sm text-right">{{ line.debit }}</td>
						<td class="px-6 py-3 text-sm text-right">{{ line.credit }}</td>
					</tr>
					{% empty %}
					<tr><td colspan="4" class="px-6 py-6 text-center text-gray-500">Нет строк</td></tr>
					{% endfor %}
				</tbody>
				<tfoot class="bg-gray-50">
					<tr>
						<td colspan="2" class="px-6 py-3 text-right font-medium text-gray-700">Итого</td>
						<td class="px-6 py-3 text-right">{{ entry.total_debit }}</td>
						<td class="px-6 py-3 text-right">{{ entry.total_credit }}</td>
					</tr>
				</tfoot>
			</table>
		</div>
	</div>
	<div id="add-line" class="bg-white border border-gray-200 rounded-lg p-6">
		<h2 class="text-lg font-semibold text-gray-900 mb-3">Добавить строку</h2>
		<form method="post">
			{% csrf_token %}
			<div class="grid grid-cols-1 md:grid-cols-4 gap-4">
				<div class="md:col-span-2">{{ line_form.account }}</div>
				<div>{{ line_form.debit }}</div>
				<div>{{ line_form.credit }}</div>
				<div class="md:col-span-4">{{ line_form.description }}</div>
			</div>
			<div class="flex justify-end mt-4">
				<button class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded">Добавить</button>
			</div>
		</form>
	</div>
</div>
{% endblock %} 