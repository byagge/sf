<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–∞—à–±–æ—Ä–¥ –º–∞—Å—Ç–µ—Ä–∞ - –¢–µ—Å—Ç</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .error { color: red; background: #ffe6e6; padding: 10px; border-radius: 5px; }
        .success { color: green; background: #e6ffe6; padding: 10px; border-radius: 5px; }
        .info { color: blue; background: #e6f3ff; padding: 10px; border-radius: 5px; }
        .card { border: 1px solid #ddd; padding: 15px; margin: 10px 0; border-radius: 5px; }
        pre { background: #f5f5f5; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>–î–∞—à–±–æ—Ä–¥ –º–∞—Å—Ç–µ—Ä–∞ - –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</h1>
    
    {% if error %}
        <div class="error">
            <h3>–û—à–∏–±–∫–∞:</h3>
            <p>{{ error }}</p>
        </div>
    {% endif %}
    
    {% if stats %}
        <div class="success">
            <h3>‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!</h3>
        </div>
        
        <div class="card">
            <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–∞—Å—Ç–µ—Ä–µ:</h3>
            <p><strong>ID:</strong> {{ stats.master_info.id }}</p>
            <p><strong>–ò–º—è:</strong> {{ stats.master_info.name }}</p>
            <p><strong>Email:</strong> {{ stats.master_info.email }}</p>
        </div>
        
        <div class="card">
            <h3>–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</h3>
            <p><strong>–í—Å–µ–≥–æ —Ü–µ—Ö–æ–≤:</strong> {{ stats.overall_stats.total_workshops }}</p>
            <p><strong>–í—Å–µ–≥–æ –∑–∞–¥–∞—á:</strong> {{ stats.overall_stats.total_tasks }}</p>
            <p><strong>–í—ã–ø–æ–ª–Ω–µ–Ω–æ –∑–∞–¥–∞—á:</strong> {{ stats.overall_stats.completed_tasks }}</p>
            <p><strong>–í—Å–µ–≥–æ —ç—Ç–∞–ø–æ–≤:</strong> {{ stats.overall_stats.total_stages }}</p>
            <p><strong>–ê–∫—Ç–∏–≤–Ω—ã—Ö —ç—Ç–∞–ø–æ–≤:</strong> {{ stats.overall_stats.active_stages }}</p>
            <p><strong>–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö —ç—Ç–∞–ø–æ–≤:</strong> {{ stats.overall_stats.completed_stages }}</p>
            <p><strong>–í—Å–µ–≥–æ –±—Ä–∞–∫–∞:</strong> {{ stats.overall_stats.total_defects }}</p>
            <p><strong>–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:</strong> {{ stats.overall_stats.efficiency|floatformat:1 }}%</p>
        </div>
        
        <div class="card">
            <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –Ω–µ–¥–µ–ª—é:</h3>
            <p><strong>–í—ã–ø–æ–ª–Ω–µ–Ω–æ –∑–∞–¥–∞—á:</strong> {{ stats.period_stats.week.completed_tasks }}</p>
            <p><strong>–ë—Ä–∞–∫–∞:</strong> {{ stats.period_stats.week.defects }}</p>
            <p><strong>–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:</strong> {{ stats.period_stats.week.efficiency|floatformat:1 }}%</p>
        </div>
        
        <div class="card">
            <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –º–µ—Å—è—Ü:</h3>
            <p><strong>–í—ã–ø–æ–ª–Ω–µ–Ω–æ –∑–∞–¥–∞—á:</strong> {{ stats.period_stats.month.completed_tasks }}</p>
            <p><strong>–ë—Ä–∞–∫–∞:</strong> {{ stats.period_stats.month.defects }}</p>
            <p><strong>–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:</strong> {{ stats.period_stats.month.efficiency|floatformat:1 }}%</p>
        </div>
        
        <div class="card">
            <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ü–µ—Ö–∞–º ({{ stats.workshops|length }}):</h3>
            {% for workshop in stats.workshops %}
                <div style="border: 1px solid #eee; padding: 10px; margin: 5px 0; border-radius: 3px;">
                    <h4>{{ workshop.name }}</h4>
                    <p><strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> {{ workshop.description|default:"–ù–µ —É–∫–∞–∑–∞–Ω–æ" }}</p>
                    <p><strong>–í—Å–µ–≥–æ –∑–∞–¥–∞—á:</strong> {{ workshop.total_tasks }}</p>
                    <p><strong>–í—ã–ø–æ–ª–Ω–µ–Ω–æ:</strong> {{ workshop.completed_tasks }}</p>
                    <p><strong>–ë—Ä–∞–∫–∞:</strong> {{ workshop.defects }}</p>
                    <p><strong>–ê–∫—Ç–∏–≤–Ω—ã—Ö —ç—Ç–∞–ø–æ–≤:</strong> {{ workshop.active_stages }}</p>
                    <p><strong>–°–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤:</strong> {{ workshop.employees_count }}</p>
                    <p><strong>–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:</strong> {{ workshop.efficiency|floatformat:1 }}%</p>
                </div>
            {% endfor %}
        </div>
        
        <div class="card">
            <h3>–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</h3>
            <pre>{{ stats|pprint }}</pre>
        </div>
        
    {% else %}
        <div class="info">
            <h3>‚ÑπÔ∏è –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞</h3>
            <p>–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:</p>
            <ul>
                <li>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –º–∞—Å—Ç–µ—Ä–æ–º</li>
                <li>–ú–∞—Å—Ç–µ—Ä –Ω–µ —É–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∏ –æ–¥–Ω–∏–º —Ü–µ—Ö–æ–º</li>
                <li>–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö</li>
            </ul>
        </div>
    {% endif %}
    
    <div class="card">
        <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ:</h3>
        <p><strong>ID:</strong> {{ user.id }}</p>
        <p><strong>Username:</strong> {{ user.username }}</p>
        <p><strong>–ò–º—è:</strong> {{ user.first_name }}</p>
        <p><strong>–§–∞–º–∏–ª–∏—è:</strong> {{ user.last_name }}</p>
        <p><strong>Email:</strong> {{ user.email }}</p>
        <p><strong>–†–æ–ª—å:</strong> {{ user.role }}</p>
        <p><strong>–¶–µ—Ö:</strong> {{ user.workshop.name|default:"–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω" }}</p>
    </div>
    
    <div class="card">
        <h3>–î–µ–π—Å—Ç–≤–∏—è:</h3>
        <p><a href="/workshops/">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ —Ü–µ—Ö–∞–º</a></p>
        <p><a href="/workshops/master/">üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É</a></p>
    </div>
</body>
</html> 